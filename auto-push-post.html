<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
        content="Auto Pusher ‚Äî Keep Your GitHub Streak Alive. A simple tool to automatically push to your GitHub repository to maintain your contribution streak.">
    <meta name="author" content="Katzir">
    <title>Auto Pusher ‚Äî Keep Your GitHub Streak Alive</title>
    <link rel="icon" href="assets/img/A_flat_digital_vector_illustration_of_a_unicorn_he.png" type="image/png" />
    <link rel="stylesheet" href="assets/css/styles.css">

    <style>
        body {
            color: #333;
            background: #f7f7f7;
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
        }

        .blog-post {
            max-width: 700px;
            margin: 2rem auto;
            padding: 2rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            text-align: left;
        }

        .blog-post h1 {
            font-size: 2rem;
            color: #1a1a1a;
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .blog-post h2,
        .blog-post h3 {
            margin-top: 2rem;
            color: #2e7df6;
            font-weight: 600;
        }

        .meta {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 2rem;
        }

        .blog-post p {
            margin-bottom: 1.25rem;
        }

        .blog-post pre {
            background: #f0f0f0;
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .blog-post code {
            background: #f0f0f0;
            padding: 2px 4px;
            border-radius: 4px;
            font-family: 'Fira Mono', monospace;
        }

        .blog-post blockquote {
            border-left: 4px solid #2e7df6;
            padding-left: 1rem;
            color: #555;
            margin: 1.5rem 0;
        }

        a {
            color: #2e7df6;
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: border-color 0.2s;
        }

        a:hover {
            border-color: #2e7df6;
            color: #2e7df6;
        }

        .back-link {
            display: inline-block;
            margin-top: 2rem;
            font-weight: 500;
        }

        header.site-header,
        footer.site-footer {
            background: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        header.site-header h1 {
            margin: 0;
            font-size: 1.5rem;
            color: #2e7df6;
        }

        header.site-header .meta {
            margin: 0.5rem 0 0;
            font-size: 0.9rem;
            color: #777;
        }

        footer.site-footer {
            text-align: center;
            font-size: 0.9rem;
            color: #888;
            margin-top: 3rem;
        }
    </style>

</head>

<body>
    <div class="nav-placeholder" id="nav-placeholder"></div>

    <main class="container">
        <article class="blog-post">
            <header class="post-header">
                <h1>Auto Pusher üñ•Ô∏è‚ûïüöÄ</h1>
                <div class="meta">June 29, 2025 ‚Ä¢ 6 min read</div>
            </header>

            <h2>The Origin Story</h2>
            <p>
                One evening, after realizing my GitHub streak had dropped once again, I decided enough was enough.
                I needed a tool to handle those daily ‚Äúkeeping-alive‚Äù commits automatically‚Äîno babysitting, no extra
                dependencies.
                Thus, <strong>Auto Pusher</strong> was born: a small suite of scripts that fetch a free ZenQuotes API
                quote, append it to <code>quotes.txt</code>, and push to GitHub, all scheduled on Windows via
                PowerShell.
            </p>

            <h2>Project Layout</h2>
            <p>
                Here‚Äôs how I organized the repo:
            </p>
            <ul>
                <li><code>README.md</code> ‚Äî Overview and instructions</li>
                <li><code>.env.example</code> ‚Äî Template for your settings</li>
                <li><code>auto_commit.sh</code> ‚Äî The one Bash script that actually does the work</li>
                <li><code>auto_commit.ps1</code> ‚Äî PowerShell wrapper to run the Bash script on Windows</li>
                <li><code>setup.ps1</code> ‚Äî Installs prerequisites and creates your <code>.env</code></li>
                <li><code>schedule_tasks.ps1</code> ‚Äî Registers the daily Windows Task Scheduler job</li>
                <li><code>quotes.txt</code> ‚Äî The log file where quotes accumulate</li>
            </ul>

            <h2><code>README.md</code> ‚Äî Your First Stop</h2>
            <p>
                The README is your doorway. It explains:
            </p>
            <ul>
                <li>Why Auto Pusher exists</li>
                <li>Prerequisites: Git Bash, <code>jq</code>, and Windows PowerShell</li>
                <li>Step-by-step install &amp; scheduling</li>
            </ul>
            <p>Whenever you need a refresher, this is the file to open:</p>
            <pre><code>https://github.com/ItakatzI/auto-pusher/blob/main/README.md</code></pre>

            <h2><code>.env.example</code> ‚Äî Secret Sauce</h2>
            <p>
                To avoid hard-coding credentials and file names, I use an environment file.
                Copy it to <code>.env</code> and fill in your values:
            </p>
            <pre><code># .env.example
REPO_DIR=/c/path/to/your/repo-to-commit
REPO_ALT=/c/path/to/your/another-repo-to-commit
REPO_DIR2=C:\Users\path\to\auto-push\folder\quotesForGit
TARGET_FILE=quotes.txt
</code></pre>
            <p>
                This file is <strong>ignored</strong> by Git, so your personal tokens or emails never leak.
            </p>

            <h2><code>auto_commit.sh</code> ‚Äî The Heart in Bash</h2>
            <p>
                Although this project lives on Windows, I wrote the core in Bash to keep it lightweight and
                dependency-free. Its meant to be used on two repositories, alternating between them to contribute to two GitHub repositories.:
            </p>
            <pre><code>#!/usr/bin/env bash

# === Config ===
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
ENV_PATH="$SCRIPT_DIR/.env"
LOG_PATH="$SCRIPT_DIR/push_log.txt"
# state file to remember which repo was used last time
LAST_REPO_FILE="$SCRIPT_DIR/.last_repo"

# Log to both file and terminal
exec > >(tee -a "$LOG_PATH") 2>&1

echo "[$(date '+%Y-%m-%d %H:%M:%S')] Starting auto_commit.sh"

# === Load .env ===
if [ -f "$ENV_PATH" ]; then
  export $(grep -v '^#' "$ENV_PATH" | xargs)
else
  echo "[‚úò] .env file not found at $ENV_PATH"
  exit 1
fi

# === Sanity Check ===
if [ -z "$REPO_DIR" ] || [ -z "$REPO_ALT" ] || [ -z "$TARGET_FILE" ]; then
  echo "[‚úò] Missing REPO_DIR, REPO_ALT or TARGET_FILE in .env"
  exit 1
fi

# === Choose which repo to use this run ===
if [ -f "$LAST_REPO_FILE" ]; then
  LAST=$(cat "$LAST_REPO_FILE")
else
  # default so that first run uses REPO_DIR
  LAST="ALT"
fi

if [ "$LAST" = "ALT" ]; then
  REPO="$REPO_DIR"
  echo "DIR" >"$LAST_REPO_FILE"
else
  REPO="$REPO_ALT"
  echo "ALT" >"$LAST_REPO_FILE"
fi

echo "[‚úî] Using repo: $REPO"

cd "$REPO" || {
  echo "[‚úò] Failed to cd into $REPO"
  exit 1
}
git pull
# === Commit settings ===
MIN_COMMITS=${MIN_COMMITS:-1}
MAX_COMMITS=2
NUM_COMMITS=$((RANDOM % (MAX_COMMITS - MIN_COMMITS + 1) + MIN_COMMITS))

echo "[‚úî] Planning $NUM_COMMITS motivational commits..."

for ((i = 0; i < NUM_COMMITS; i++)); do
  echo "[‚Üí] Commit $((i + 1)) of $NUM_COMMITS"

  # Fetch a quote
  RESPONSE=$(curl -s https://zenquotes.io/api/random)
  if [ -z "$RESPONSE" ]; then
    echo "[!] Failed to fetch quote, skipping..."
    continue
  fi

  # Extract and sanitize quote
  RAW_QUOTE=$(echo "$RESPONSE" | sed -n 's/.*"q":"\([^"]*\)".*/\1/p')
  RAW_AUTHOR=$(echo "$RESPONSE" | sed -n 's/.*"a":"\([^"]*\)".*/\1/p')
  if [ -z "$RAW_QUOTE" ] || [ -z "$RAW_AUTHOR" ]; then
    echo "[!] Invalid quote structure, skipping..."
    continue
  fi

  CLEAN_QUOTE=$(echo "$RAW_QUOTE ‚Äî $RAW_AUTHOR" | iconv -f utf-8 -t ascii//TRANSLIT | tr -cd '\11\12\15\40-\176')

  # Append and commit
  git checkout -b "NewDailyQuote"
  printf "# %s\n" "$CLEAN_QUOTE" >>"$TARGET_FILE"
  git add "$TARGET_FILE"
  git commit -m "Motivation: \"$CLEAN_QUOTE\" ($(date '+%Y-%m-%d %H:%M:%S'))"
  git checkout main
  git merge NewDailyQuote
  git branch -d NewDailyQuote
  git push

  echo "[üí¨] $CLEAN_QUOTE"

  # Windows notification (requires BurntToast module)
  ESCAPED_QUOTE=$(echo "$CLEAN_QUOTE" | sed "s/'/''/g")

  powershell.exe -Command "[System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms') | Out-Null; [System.Windows.Forms.MessageBox]::Show('$ESCAPED_QUOTE','Motivation')"

done

echo "[‚úî] Completed $NUM_COMMITS commits."

# Push straight to main
git push origin HEAD:main</code></pre>
            <p>
                It <em>must</em> run inside Git Bash or WSL‚Äîstandard Bash on Windows without Git won‚Äôt work.
            </p>

            <p>
                This script does the heavy lifting:
                It fetches a random quote from ZenQuotes, appends it to <code>quotes.txt</code>, and commits it.
                It alternates between two repositories to keep your contributions diverse.
                It also handles basic error checking and logging.
            </p>
            <h2><code>setup.ps1</code> ‚Äî One-Click Setup</h2>
            <p>
                Rather than manually installing <code>jq</code> and copying <code>.env</code>, I automated it:
            </p>
            <pre><code>
                # setup.ps1

# --- Load .env file ---
function Load-EnvFile {
    $envPath = Join-Path $PSScriptRoot ".env"
    if (Test-Path $envPath) {
        Get-Content $envPath | ForEach-Object {
            if ($_ -match '^\s*([^#][^=]*)\s*=\s*(.*)\s*$') {
                [System.Environment]::SetEnvironmentVariable($matches[1].Trim(), $matches[2].Trim())
            }
        }
    } else {
        Write-Error "[‚úò] .env file not found at $envPath"
        exit 1
    }
}

Load-EnvFile

# --- Get paths from .env ---
$projectPath = $env:REPO_DIR2
if (-not $projectPath) {
    Write-Error "[X] REPO_DIR2 not defined in .env"
    exit 1
}

$scheduleScript = Join-Path $projectPath "schedule_tasks.ps1"
$bashScript = Join-Path $projectPath "auto_commit.sh"

if (-not (Test-Path $scheduleScript)) {
    Write-Error "[X] schedule_tasks.ps1 not found at $scheduleScript"
    exit 1
}

if (-not (Test-Path $bashScript)) {
    Write-Error "[X] auto_commit.sh not found at $bashScript"
    exit 1
}

# --- Inform user ---
Write-Host "[V] Loaded environment variables from .env"
Write-Host "  > Project path: $projectPath"
Write-Host "  > Bash script:  $bashScript"
Write-Host ""

# --- Run today's schedule creation ---
Write-Host "[‚Üí] Running schedule_tasks.ps1 to create today‚Äôs random push tasks..."
powershell.exe -ExecutionPolicy Bypass -File "`"$scheduleScript`""

# --- Schedule the daily randomization task ---
Write-Host "[‚Üí] Scheduling 'WhitespacePushDailyScheduler' at 11:00 AM..."

$dailyTrigger = New-ScheduledTaskTrigger -Daily -At 11:00am
$dailyAction = New-ScheduledTaskAction -Execute "powershell.exe" -Argument "-ExecutionPolicy Bypass -File `"$scheduleScript`""

Register-ScheduledTask -Action $dailyAction -Trigger $dailyTrigger -TaskName "WhitespacePushDailyScheduler" -Description "Daily re-randomization of motivational commit tasks" -Force

Write-Host "[V] Scheduled task 'WhitespacePushDailyScheduler' successfully"

            </code></pre>
            <p>
                <p>
                    Run this once after cloning to get your environment ready. It sets up the necessary paths and registers the daily task.
                </p>
            </p>

            <h2><code>schedule_tasks.ps1</code> ‚Äî Wake Up and Go</h2>
            <p>
                Finally, I register a Scheduled Task that runs <code>auto_commit.ps1</code> daily at 8 pm:
            </p>
            <pre><code># === schedule_tasks.ps1 ===

# --- Log execution ---
Add-Content -Path "$env:USERPROFILE\push_scheduler_log.txt" -Value "[$(Get-Date)] schedule_tasks.ps1 executed"

# --- Load .env ---
$envPath = "$PSScriptRoot\.env"
if (!(Test-Path $envPath)) {
    Write-Error ".env file not found at $envPath"
    exit 1
}

Get-Content $envPath | ForEach-Object {
    if ($_ -match '^\s*([^#][^=]+?)\s*=\s*(.+)$') {
        [System.Environment]::SetEnvironmentVariable($matches[1].Trim(), $matches[2].Trim())
    }
}

# --- Validate REPO_DIR ---
$repoDir = $env:REPO_DIR2
if (-not $repoDir) {
    Write-Error "REPO_DIR not defined in .env"
    exit 1
}
# Convert /c/... style to Windows path if needed
$windowsRepoDir = $repoDir 
# Path to script
$scriptPath = Join-Path $windowsRepoDir "auto_commit.sh"
if (-not (Test-Path $scriptPath)) {
    Write-Error "auto_commit.sh not found at $scriptPath"
    exit 1
}




# --- Git Bash path ---
$bashPath = "C:\Program Files\Git\bin\bash.exe"
if (-not (Test-Path $bashPath)) {
    Write-Error "Git Bash not found at $bashPath"
    exit 1
}



# --- Cleanup old tasks ---
Get-ScheduledTask | Where-Object { $_.TaskName -like "WhitespacePush_*" } | Unregister-ScheduledTask -Confirm:$false



$logFile = "$env:USERPROFILE\auto_commit_output.log"

# --- Schedule new tasks ---
$numTasks = Get-Random -Minimum 0 -Maximum 3
$logFile = "$env:TEMP\push_log.txt"

for ($i = 0; $i -lt $numTasks; $i++) {
    $hour = Get-Random -Minimum 11 -Maximum 17
    $minute = Get-Random -Minimum 0 -Maximum 59
    $time = "{0:D2}:{1:D2}" -f $hour, $minute
    $taskName = "WhitespacePush_$i"

    # Properly escaped Bash command
    $bashCommand = "-c `"cd '$repoDir' && bash ./auto_commit.sh | tee -a '$logFile'`""

    $action = New-ScheduledTaskAction -Execute $bashPath -Argument $bashCommand
    $trigger = New-ScheduledTaskTrigger -Daily -At $time

    Register-ScheduledTask -Action $action -Trigger $trigger -TaskName $taskName -Description "Random motivational push" -Force

    Write-Output "[V] Task $taskName scheduled at $time"
}

Write-Output "[V] $numTasks task(s) scheduled. Logs go to $logFile"
</code></pre>
            <p>
                Now, every evening you‚Äôll see a fresh commit‚Äîand a new quote in your GitHub stats.
            </p>

            <h2><code>quotes.txt</code> ‚Äî Your Daily Log</h2>
            <p>
                This plain text file is where quotes accumulate.
                It‚Äôs appended to each run, so over time you build a neat archive of inspiration.
            </p>

            <h2>Lessons Learned &amp; Pitfalls</h2>
            <ul>
                <li><strong>Windows Path quirks:</strong> Make sure Git Bash is in your PATH, or the scheduled job will
                    silently fail.</li>
                <li><strong>ZenQuotes limits:</strong> Free tier has a rate limit‚Äîif you hammer the API, you‚Äôll get
                    empty responses. Caching or backoff helps.</li>
                <li><strong>Merge collisions:</strong> Avoid editing <code>quotes.txt</code> manually. The script always
                    commits straight to <code>main</code> to sidestep conflicts.</li>
                <li><strong>Scheduler timing:</strong> If your PC is off at 8 pm, Task Scheduler won‚Äôt run. Consider the
                    ‚ÄúStart the task as soon as possible after a scheduled start is missed‚Äù option.</li>
            </ul>

            <h2>Get the Code</h2>
            <p>
                Dive in and try it yourself:
                <a href="https://github.com/ItakatzI/auto-pusher" target="_blank" rel="noopener">
                    github.com/ItakatzI/auto-pusher
                </a>
            </p>
            <div class="back-link">
                <a href="Blog.html">‚Üê Back to all posts</a>
            </div>
        </article>

    </main>
    <footer class="site-footer">
        <div class="container">
            <p>¬© 2025 Katzir. All rights reserved.</p>
        </div>
    </footer>

    <script src="scripts/include-nav.js"></script>
</body>

</html>